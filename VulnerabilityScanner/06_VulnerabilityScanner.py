#!/usr/bin/python3

"""
Program_6
The Most Basic Vulnerability Scanner!
"""
import socket


def retBanner(ip,port):
    s = socket.socket()
    try:
        s.connect((ip,port))
        res = s.recv(1024)
        return res
    except Exception as e:
        print("[-] Error - "+str(e))
        return


def checkVulns(res):
    f = open("vulns.txt",'r')
    for line in f.readline():
        if( line.strip('\r') in res ):
            print("[+] - "+ line +" is vulnerable")
            return
    return


def main():
    portlist = [21,22,25,80,110,443]
    for i in range(0,254):
        for port in portlist:
            ip = "192.168.0."+str(i)
            banner = retBanner(ip,port)
            if(banner):
                print("[+] "+ip+":"+str(port)+banner.strip('\n'))
                checkVulns(banner)


if __name__ == '__main__':
    main()
