#!/usr/bin/python3

"""
Program_5
The Most Basic Vulnerability Scanner!
"""
import socket


def retBanner(ip,port):
    s = socket.socket()
    try:
        s.connect((ip,port))
        res = s.recv(1024)
        return res
    except Exception as e:
        print("[-] Error - "+str(e))
        return


def checkVulns(res):
    if("FreeFloat ftp server version 1.00 " in res):
        print("[+] The FreeFloat Server is vulnerable")
    elif("3Com 3CDaemon Ftp Server Version 2.0" in res):
        print("[+] The 3Com Server is Vulnerable")
    elif("Ability Server 2.34" in res):
        print("[+] The Ability server is vulnerable")
    elif("Sami Ftp Server 2.0.2" in res):
        print("[+] Sami Server is vulnerable")
    else:
        print("[-] The FTP Server isn\'t Vulnerable")
    return


def main():
    portlist = [21,22,25,80,110,443]
    for i in range(0,254):
        for port in portlist:
            ip = "192.168.0."+str(i)
            banner = retBanner(ip,port)
            if(banner):
                print("[+] "+ip+":"+str(port)+banner.strip('\n'))
                checkVulns(banner)


if __name__ == '__main__':
    main()
